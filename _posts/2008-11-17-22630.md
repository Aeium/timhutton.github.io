---
layout: post
title: vortices
---

<div class="entry-item s2-entrytext">I seem to spend a lot of my spare time playing with cellular automata. Here's a simple model of gases:<br/><br/>image:<br/><img src="http://lh6.ggpht.com/_L3XQL9bgmnM/SR9TIFjytEI/AAAAAAAABvU/AdooQ2Ay0fw/s800/lga_particles.jpg"/><br/>video:<br/><iframe allowfullscreen="" class="lj_embedcontent" frameborder="0" height="250" name="embed_4339226_4" src="http://l.lj-toys.com/?auth_token=sessionless%3A1491904800%3Aembedcontent%3A4339226%264%26%260%3Ad2606f3547d043e7996af7dd5029ac4a433135a5&amp;moduleid=4&amp;preview=0&amp;journalid=4339226&amp;noads=" width="350"></iframe><br/>Squares move around on a grid, bouncing off each other and the walls.<br/><br/>The amazing thing about this model is this: run it on a bigger grid and you get an accurate simulation of flow patterns. And that means turbulence and swirling eddies and wisps of smoke and things like that:<br/><br/>image:<br/><img src="http://lh5.ggpht.com/_L3XQL9bgmnM/SR9UsJfZuyI/AAAAAAAABvo/AfxEGYkSQdA/s400/eddies.jpg"/><br/>video:<br/><iframe allowfullscreen="" class="lj_embedcontent" frameborder="0" height="150" name="embed_4339226_5" src="http://l.lj-toys.com/?auth_token=sessionless%3A1491904800%3Aembedcontent%3A4339226%265%26%260%3Abef8884d8b7aa1ed6768394b1ad6e6f8e79ddfa3&amp;moduleid=5&amp;preview=0&amp;journalid=4339226&amp;noads=" width="350"></iframe><br/>All we've done is run it on a larger grid (3000x1000) and to show the direction of the local flow with lines. We make the fluid flow from left to right by simply overwriting the left-hand column with particles moving to the right. An obstacle disrupts the flow, shedding eddies in its wake.<br/><br/>The question asks itself: Why does this work? Why does such a simple model of bouncing particles yield a good model of flow? The key is that the particles conserve momentum: they keep moving until they collide, and the particles after a collision have the same total momentum as the particles before the collision. And so over a larger area you get two things happening: a) the fluid will tend to move into areas of lower pressure (particles get bounced out of higher density areas), and b) if an area of fluid has an overall momentum it will get carried forward, pushing against whatever it encounters. It's a delightful system and makes pretty pictures.<br/><br/>Further reading:<ul><li>This pattern of vortices behind an obstacle is called a <a href="http://en.wikipedia.org/wiki/Von_K%C3%A1rm%C3%A1n_vortex_street" rel="nofollow">von Karman vortex street</a>. The wikipedia page has some nice photos of real examples, and also tells me that bees use these vortices to fly.</li><li>The C++ source code and executables are available here: <a href="http://code.google.com/p/latticegas" rel="nofollow">http://code.google.com/p/latticegas</a></li><li>Here we're using a 'pair interaction lattice gas' but there are many others. All things lattice gas are explained here: <a href="http://new.math.uiuc.edu/im2008/dakkak/papers/files/Wol2000c.pdf" rel="nofollow">PDF (2.4MB)</a></li></ul><br/><br/>Notes:<ul><li>In the particles images, the colour shows which direction they are moving in: grey particles jiggle on the spot, green ones move south-west, turquoise particles move west (sometimes jiggling up and down as they go), etc.</li><li>In the particles images, the top and bottom walls are fixed boundaries - the particles bounce off them. The left and right walls wrap around, so a particle leaving stage right immediately enters stage left. The same thing is true in the bigger grid, except that particles are pumped-in on the left.</li><li>In the eddies video we have subtracted the constant left-to-right flow from each flow vector, to better show the flow patterns. In the eddies <i>image</i> we've subtracted the long-term average flow at each point, which shows the vortices clearly.</li><li>Lattice gases are pretty much obsolete now, there are better models to use if you're a hydrodynamicist. But they're still cute.</li></ul></div><p><hr></p><p>This post was <a href="http://ferkeltongs.livejournal.com/22630.html">originally on LiveJournal</a>.</p>